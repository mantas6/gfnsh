#!/bin/bash

cwd=$(dirname "$0")

event=$1
mac=$2
ip=$3
hostname=$4

leases_file=/var/lib/dnsmasq/dnsmasq.leases


[ "$event" != "add" ] && exit 0

push() {
    "$cwd/modules/pushover.sh/pushover.sh" "$1" \
        -f /root/.config/pushover.conf
}

message="Client connected $mac $hostname Assigned IP $ip"
echo "$message"

grep -qx "$mac" "$leases_file" || push "$message"

