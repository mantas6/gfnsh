#!/bin/bash

cwd=$(dirname "$0")

event=$1
mac=$2
ip=$3
hostname=$4

leases_file=/var/lib/dnsmasq/dnsmasq.leases


[ "$event" = "remove" ] && exit 0

push() {
    "$cwd/modules/pushover.sh/pushover.sh" -f /root/.config/pushover.conf "$1"
}

message="Client connected $mac $hostname Assigned IP $ip"
echo "$message"

grep -qx "$mac" "$leases_file" || push "$message"

